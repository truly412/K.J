<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Event Page</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        /* 기본 CSS 스타일 */
        body {
            font-family: 'Arial', sans-serif; /* 기본 글꼴 설정 */
            background-color: #f8f9fa; /* 부드러운 배경색 */
            color: #343a40; /* 텍스트 색상 */
            text-align: center; /* 중앙 정렬 */
        }

        .container {
            margin: 20px auto;
            padding: 20px;
            border-radius: 8px;
            background-color: white;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1); /* 그림자 효과 */
            max-width: 800px; /* 최대 너비 설정 */
        }

        #answers {
            text-align: left; /* 왼쪽 정렬 */
            margin-top: 20px; /* 위쪽 여백 추가 */
        }

        #hidden-event-message {
            font-size: 24px;
            margin-top: 20px;
            font-weight: bold; /* 굵은 글꼴 */
            color: #007BFF; /* 텍스트 색상 */
            opacity: 0; /* 초기 투명도 */
            transition: opacity 0.5s ease; /* 부드러운 전환 효과 */
        }

        /* 질문 스타일 */
        .question {
            font-weight: bold; /* 질문을 굵게 */
            font-size: 18px; /* 질문 크기 조정 */
            margin-bottom: 5px; /* 질문과 답변 간의 여백 */
        }

        /* 답변 스타일 */
        .answer {
            font-size: 16px; /* 답변 크기 조정 */
            color: #495057; /* 답변 색상 */
            margin-bottom: 15px; /* 각 답변 간의 여백 */
        }

        /* 글자 애니메이션을 위한 스타일 */
        .letter {
            display: inline-block; /* 각 글자가 개별적으로 표시되도록 설정 */
            transform: translateY(20px); /* 초기 위치 조정 */
            opacity: 0; /* 초기 투명도 */
            transition: transform 0.4s ease, opacity 0.4s ease; /* 부드러운 전환 효과 */
        }

        .letter.show {
            transform: translateY(0); /* 제자리로 돌아오기 */
            opacity: 1; /* 완전 불투명 */
        }

        /* 버튼 스타일 */
        .button-container {
            display: none; /* 초기에는 숨김 */
            margin-top: 20px; /* 버튼 상단 여백 */
        }

        .button-container button {
            padding: 10px 20px; /* 버튼 여백 */
            font-size: 16px; /* 버튼 글자 크기 */
            margin: 0 10px; /* 버튼 간격 */
            cursor: pointer; /* 마우스 커서 포인터 */
        }

        .button-container button.yes {
            background-color: #28a745; /* 초록색 배경 */
            color: white; /* 흰색 텍스트 */
            border: none; /* 테두리 제거 */
            border-radius: 5px; /* 모서리 둥글게 */
        }

        .button-container button.no {
            background-color: #dc3545; /* 빨간색 배경 */
            color: white; /* 흰색 텍스트 */
            border: none; /* 테두리 제거 */
            border-radius: 5px; /* 모서리 둥글게 */
        }
    </style>
</head>

<body>

    <div class="container">
        <h1>당신의 선택</h1>
        <div id="answers"></div> <!-- 답변을 표시할 영역 -->

        <!-- 새로운 div 추가 -->
        <div id="hidden-event-message"></div>
        <div class="button-container" id="button-container">
            <button class="yes" id="yes-btn">YES</button>
            <button class="no" id="no-btn">NO</button>
        </div>
    </div>

    <script>
        // localStorage에서 답변을 가져와 화면에 표시
        const answers = JSON.parse(localStorage.getItem('answers'));
        console.log(answers);

        if (answers) {
            const answerDisplay = document.getElementById('answers');

            // 각 질문에 대한 답변을 보여줌
            const answerText = `
                <div class="question">Q1: 주기적으로 새로운 친구를 사귄다</div>
                <div class="answer">A: ${getAnswerText(answers.q1)}</div>
                <div class="question">Q2: 단순하고 직관적인 아이디어보다는 복잡하고 참신한 아이디어에 흥미를 느낀다</div>
                <div class="answer">A: ${getAnswerText(answers.q2)}</div>
                <div class="question">Q3: 일반적으로 사실에 기반한 주장보다 감정적으로 공감 가는 내용이 더 설득력 있다고 느낀다</div>
                <div class="answer">A: ${getAnswerText(answers.q3)}</div>
            `;
            answerDisplay.innerHTML = answerText;

            // 확인 창 표시
            if (calculateTotalScore(answers) > 10) {
                // 메시지를 한 글자씩 표시하는 함수 호출
                showMessage("합산 점수 10을 넘었음으로 히든 이벤트가 발생합니다. 이벤트를 진행하시겠습니까?");
            }
        }

        // 선택한 값에 맞는 텍스트로 변환
        function getAnswerText(value) {
            switch (value) {
                case '4': return '강지가 너무 좋다.';
                case '3': return '강지가 좋다.';
                case '2': return '강지가 그저 그렇다.';
                case '1': return '도대체 강지를 왜 만나는지 모르겠다.';
                default: return '선택하지 않음';
            }
        }

        // 합산 점수를 계산하는 함수
        function calculateTotalScore(answers) {
            let totalScore = 0;
            for (let key in answers) {
                totalScore += parseInt(answers[key]); // 선택한 값들을 합산
            }
            return totalScore;
        }

        // 메시지를 한 글자씩 출력하는 함수
        // 메시지를 한 글자씩 출력하는 함수
function showMessage() {
    const message = "합산 점수 10을 넘었음으로 히든 이벤트가 발생합니다.\n이벤트를 진행하시겠습니까?";
    const messageContainer = document.getElementById('hidden-event-message');
    messageContainer.textContent = ''; // 초기화
    messageContainer.style.opacity = 1; // 초기 투명도 설정

    // 메시지를 줄바꿈 문자 기준으로 분리
    const messageLines = message.split('\n');

    // 각 줄마다 글자를 표시
    let currentLine = 0;

    const displayLine = () => {
        if (currentLine < messageLines.length) {
            const formattedMessage = messageLines[currentLine].split('').map(char => char === ' ' ? '\u00A0' : char).join('');

            // 메시지의 각 글자를 span 요소로 추가
            for (let char of formattedMessage) {
                const span = document.createElement('span');
                span.textContent = char;
                span.className = 'letter'; // letter 클래스 추가
                messageContainer.appendChild(span); // 메시지 컨테이너에 추가
            }

            // 글자를 순차적으로 보여주는 애니메이션
            const letters = messageContainer.querySelectorAll('.letter');
            letters.forEach((letter, index) => {
                setTimeout(() => {
                    letter.classList.add('show'); // show 클래스 추가로 애니메이션 시작
                }, index * 100); // 각 글자마다 100ms 딜레이
            });

            // 모든 글자가 나타난 후 다음 줄을 보여줍니다.
            setTimeout(() => {
                currentLine++;
                messageContainer.appendChild(document.createElement('br')); // 줄바꿈 추가
                displayLine(); // 다음 줄 표시
            }, (formattedMessage.length + 1) * 100); // 마지막 글자 후에 추가 딜레이
        } else {
            // 마지막 줄이 끝난 후 버튼을 보여줍니다.
            setTimeout(showButtons, 500); // 버튼 보이기
        }
    };

    displayLine(); // 첫 번째 줄 표시 시작
}


        // 예 버튼 클릭 이벤트
        document.getElementById('yes-btn').addEventListener('click', function() {
            alert("이벤트가 진행됩니다.");
            // 여기서 이벤트 관련 코드를 추가하세요
        });

        // 아니오 버튼 클릭 이벤트
        document.getElementById('no-btn').addEventListener('click', function() {
            alert("이벤트가 취소되었습니다.");
        });
    </script>
</body>

</html>
