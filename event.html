<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Event Page</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        /* 추가된 CSS 스타일 */
        body {
            font-family: 'Arial', sans-serif; /* 기본 글꼴 설정 */
            background-color: #f8f9fa; /* 부드러운 배경색 */
            color: #343a40; /* 텍스트 색상 */
            text-align: center; /* 중앙 정렬 */
        }

        .container {
            margin: 20px auto;
            padding: 20px;
            border-radius: 8px;
            background-color: white;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1); /* 그림자 효과 */
            max-width: 600px; /* 최대 너비 설정 */
        }

        #hidden-event-message {
            font-size: 24px;
            margin-top: 20px;
            font-weight: bold; /* 굵은 글꼴 */
            color: #007BFF; /* 텍스트 색상 */
            opacity: 0; /* 초기 투명도 */
            transition: opacity 0.5s ease; /* 부드러운 전환 효과 */
        }

        /* 글자 애니메이션을 위한 스타일 */
        .letter {
            display: inline-block; /* 각 글자가 개별적으로 표시되도록 설정 */
            transform: translateY(20px); /* 초기 위치 조정 */
            opacity: 0; /* 초기 투명도 */
            transition: transform 0.4s ease, opacity 0.4s ease; /* 부드러운 전환 효과 */
        }

        .letter.show {
            transform: translateY(0); /* 제자리로 돌아오기 */
            opacity: 1; /* 완전 불투명 */
        }
    </style>
</head>

<body>

    <div class="container">
        <h1>당신의 선택</h1>
        <div id="answers"></div> <!-- 답변을 표시할 영역 -->

        <!-- 새로운 div 추가 -->
        <div id="hidden-event-message"></div>
    </div>

    <script>
    // localStorage에서 답변을 가져와 화면에 표시
    const answers = JSON.parse(localStorage.getItem('answers'));
    console.log(answers);

    if (answers) {
        const answerDisplay = document.getElementById('answers');

        // 각 질문에 대한 답변을 보여줌
        const answerText = `
            <p>Q1: 주기적으로 새로운 친구를 사귄다 - ${getAnswerText(answers.q1)}</p>
            <p>Q2: 단순하고 직관적인 아이디어보다는 복잡하고 참신한 아이디어에 흥미를 느낀다 - ${getAnswerText(answers.q2)}</p>
            <p>Q3: 일반적으로 사실에 기반한 주장보다 감정적으로 공감 가는 내용이 더 설득력 있다고 느낀다 - ${getAnswerText(answers.q3)}</p>
        `;
        answerDisplay.innerHTML = answerText;

        // 확인 창 표시
        if (calculateTotalScore(answers) > 10) {
            // 메시지를 한 글자씩 표시하는 함수 호출
            showMessage("합산점수 10을 넘었음으로 히든 이벤트가 발생합니다.");
        }
    }

    // 선택한 값에 맞는 텍스트로 변환
    function getAnswerText(value) {
        switch (value) {
            case '1': return '매우 그렇다';
            case '2': return '그렇다';
            case '3': return '아니다';
            case '4': return '매우 아니다';
            default: return '선택하지 않음';
        }
    }

    // 합산 점수를 계산하는 함수
    function calculateTotalScore(answers) {
        let totalScore = 0;
        for (let key in answers) {
            totalScore += parseInt(answers[key]); // 선택한 값들을 합산
        }
        return totalScore;
    }

    // 메시지를 한 글자씩 출력하는 함수
    function showMessage(message) {
        const messageContainer = document.getElementById('hidden-event-message');
        messageContainer.textContent = ''; // 초기화
        messageContainer.style.opacity = 1; // 초기 투명도 설정

        // 메시지의 각 글자를 span 요소로 추가
        for (let char of message) {
            const span = document.createElement('span');
            span.textContent = char;
            span.className = 'letter'; // letter 클래스 추가
            messageContainer.appendChild(span); // 메시지 컨테이너에 추가
        }

        // 글자를 순차적으로 보여주는 애니메이션
        const letters = document.querySelectorAll('.letter');
        letters.forEach((letter, index) => {
            setTimeout(() => {
                letter.classList.add('show'); // show 클래스 추가로 애니메이션 시작
            }, index * 100); // 각 글자마다 100ms 딜레이
        });

        // 모든 글자가 나타난 후 확인 창 띄우기
        setTimeout(confirmProceed, (message.length + 1) * 100); // 마지막 글자 후에 추가 딜레이
    }

    // 확인 창을 띄우는 함수
    function confirmProceed() {
        const confirmProceed = confirm("이벤트를 진행 하시겠습니까?");
        if (confirmProceed) {
            alert("이벤트가 진행됩니다.");
        } else {
            alert("이벤트가 취소되었습니다.");
        }
    }
</script>

